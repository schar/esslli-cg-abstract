%\begin{pre}
\documentclass[10pt,twocolumn,a4paper]{bqhatevwr}
\usepackage{etex,amsmath,mathtools,newtxtext,newtxmath,expex,natbib,tikz-qtree,bookmark,tree-dvips}%
\usepackage[margin=1in]{geometry}
\usepackage{bussproofs}\EnableBpAbbreviations
\newcommand{\pruf}[1]{\def\ScoreOverhang{0pt}\def\defaultHypSeparation{\hskip .25em}#1\DisplayProof}%
\newcommand{\lab}[1]{\RightLabel{\scriptsize #1}}
\usepackage{enumitem}
\setlist[itemize]{leftmargin=12pt}
\lingset{exskip=.5em}
\delimitershortfall=-1pt
\bibliographystyle{bqhatevwr}
\author[D.~Bumford \& S.~Charlow]{\spauthor{Dylan Bumford \\ \institute{NYU}} \AND
  \spauthor{Simon Charlow \\ \institute{Rutgers}} \AND
}
\title{Monadic dynamic semantics}
%\end{pre}
\begin{document}
%\maketitle

\section{Outline}
\begin{itemize}
	\item Continuized CCGs offer a grammar-wide generalization of scope-taking (``ubiquitous scopal pied piping'') that brings quantifiers and scope-taker more generally into the compositional fold. Three combinators, \bsf{lift}, \bsf{triv}, and \bsf{scope}, form the backbone of the grammar, allowing scope-takers to interact with their linguistic context. In addition, a \bsf{bind} shifter is introduced to facilitate quantificational binding. \citealt{Groote:2001}%
	
	\item Extant CCG treatments of E-type anaphora (i.e.~cross-sentential and donkey anaphora): \citealt{BarkerShan:2008}. Motivation for pursuing another approach. BS approach has not-so-good empirical coverage (\citealt{Charlow:2010}). \citealt{Groote:2006} does not handle scope-taking or interactions between scope-takers (can be combined with BS regime, but requires two notions of continuations---a scope and a right context---and does not extend to exceptional scope).%
	
	\item Proposal: replace \bsf{lift} and \bsf{triv} with options that countenance side effects (\citealt{Shan:2005}). Any side effects regime can be grafted onto a continuized CCG, by replacing \bsf{lift} and \bsf{triv} with monadic functors (\citealt{Moggi:1989, Wadler:1992, Wadler:1994, Wadler:1995, Shan:2002}).%
	
	\item Dynamic semantics is (\citealt{Shan:2001}):\footnote{NB: does not characterize all varieties of dynamic semantics. Dynamic treatments following \citealt{GroenendijkStokhof:1990} (e.g.~\citealt{Zimmermann:1991, Dekker:1993, Szabolcsi:2003, Groote:2006}) provide a way for indefinites to extend their binding domain but do not treat indefinites as nondeterministic analogs of proper names.}%
	\begin{itemize}
		\item State: ability to manipulate the discourse context, i.e.~create discourse referents.%
		\item Nondeterminism: analogizes indefinites to referential expressions. Treats indefinites as referring expressions, though ones which refer indeterminately.%
	\end{itemize}
	
	\item We provide a general technique for integrating a monadic approach to side effects with continuations-based approaches to scope in CCG. We relate our approach to the ContT monad transformer (\citealt{Liangetal}). Offers a type-theoretic way to track effects, integrate them into a well-developed CCG framework for scope-taking.%
	
	\item Therefore, these results are of interest both for the categorial grammarian interested in donkey anaphora and scope-taking, as well as more generally. Any side-effects regime a semanticist thinks is motivated can be accommodated along these lines. Further, because of the inherent modularity, adding side effects necessitates neither fiddling with the basic compositional machinery, nor messing with lexical items which don't exploit side effects.%
	
	\item Corollary: there is no need to settle on a single (``the'') grammar. Different and quite varied side effects regimes can be modularly grafted onto a simple applicative (``pure'') core. Lexical entries that would seem incongruous in a flat-footed standard perspective integrate seamlessly in a single grammar. %
	
	\item Monads as a natural way to extend a continuations-based grammar with tools for dynamic binding and exceptional scope. In the end: you have functional application, plus the functors from whichever monads are implicated in a given language. %
	
	\item The standard continuations-based perspective of \citealt{Barker:2002, ShanBarker:2006, BarkerShan:2014} is an instantiation of a more general perspective.%
	
	\item Standard dynamic techniques (DPL, DMG) not reducible to monads. 
	
	\item Broader question: how this relates to the idea that continuations can simulate any monad (\citealt{Filinski:1994}). I don't understand this result well enough to say anything (Dylan?). %
\end{itemize}

\section{Adding side effects}
\begin{itemize}
	\item Standard continuized grammar is, simplifying somewhat, three combinators: \bsf{lift}, \bsf{triv}, and \bsf{scope}. Figure \ref{fig1}. %
	
	\item Continuized type constructor. Agnostic about directionality. Combined with direction-sensitive mode of combination. See below. $\textsf{K}\,a\,r$ is a meaning which functions as something of type $a$ in a context of type $r$ (the `result type'). For example, extensional generalized quantifiers have type $\textsf{K}\,e\,t$.%
	\[\textsf{K}\,a\,r \Coloneqq (a \ra r) \ra r\]
	\begin{figure*}
		{\small\[\begin{array}{@{}c@{}}
		\begin{array}{c@{\hspace{2em}}c@{\hspace{2em}}c@{\hspace{2em}}c}%
			\pruf{%
			\AXC{$\Gamma \vdash f : b/a~~$}
			\AXC{$~~\Delta \vdash e : a$}
			\lab{$/$}
			\BIC{$\Gamma \cdot \Delta \vdash f\,e : b$}
			}
			&
			\pruf{%
			\AXC{$\Delta \vdash e : a~~$}
			\AXC{$~~\Gamma \vdash f : a \backslash b$}
			\lab{$\backslash$}
			\BIC{$\Delta \cdot \Gamma \vdash f\,e : b$}
			}
			&
			\pruf{%
			\AXC{$\Delta \vdash m : \textsf{K}\,(b/a)\,r~~$}
			\AXC{$~~\Gamma \vdash n : \textsf{K}\,a\,r$}
			\lab{$\sslash$}
			\BIC{$\Delta \cdot \Gamma \vdash \bsf{S}\,m\,n : \textsf{K}\,b\,r$}
			}
		\end{array}
		\\\\
		\begin{array}{c@{\hspace{2em}}c}
				\pruf{%
				\AXC{}
				\lab{\bsf{triv}}
				\UIC{$\varepsilon \vdash \lambda x.\,x : a \ra a$}
				}
				&
				\pruf{%
				\AXC{}
				\lab{\bsf{lift}}
				\UIC{$\varepsilon \vdash \lambda xk.\,k\,x:  a \ra \textsf{K}\,a\,r$}%
				}
		\end{array}
		\\[-1em]
		\end{array}\]}
		\caption{Continuized CCG without side effects, fixing a result type $r$.}%
		\label{fig1}
	\end{figure*}
	\begin{figure*}
		{\small\[\begin{array}{c}
		\begin{array}{c@{\hspace{2em}}c@{\hspace{2em}}c@{\hspace{2em}}c}%
			\pruf{%
			\AXC{$\Gamma \vdash f : b/a~~$}
			\AXC{$~~\Delta \vdash e : a$}
			\lab{$/$}
			\BIC{$\Gamma \cdot \Delta \vdash f\,e : b$}
			}
			&
			\pruf{%
			\AXC{$\Delta \vdash e : a~~$}
			\AXC{$~~\Gamma \vdash f : a \backslash b$}
			\lab{$\backslash$}
			\BIC{$\Delta \cdot \Gamma \vdash f\,e : b$}
			}
			&
			\pruf{%
			\AXC{$\Delta \vdash m : \textsf{K}\,(b/a)\,r~~$}
			\AXC{$~~\Gamma \vdash n : \textsf{K}\,a\,r$}
			\lab{$\sslash$}
			\BIC{$\Delta \cdot \Gamma \vdash \bsf{S}\,m\,n : \textsf{K}\,b\,r$}
			}
		\end{array}
		\\\\
		\begin{array}{c@{\hspace{2em}}c}
				\pruf{%
				\AXC{}
				\lab{\bsf{triv}}
				\UIC{$\varepsilon \vdash \eta : a \ra \textsf{M}\,a$}
				}
				&
				\pruf{%
				\AXC{}
				\lab{\bsf{lift}}
				\UIC{$\varepsilon \vdash (\star) :  \textsf{M}\,a \ra \textsf{K}\,a\,\textsf{M}\,r$}%
				}
		\end{array}
		\\[-1em]
		\end{array}\]}
		\caption{Continuized CCG with side effects, fixing a monad \ab{\textsf{M},\,\eta,\,\star} and a result type $r$.}%
		\label{fig2}
	\end{figure*}
	%
	\item Type-theoretic details here. Dylan: I am not entirely sure the type system makes sense. What I'm after: something basically along the lines of \citealt{ShanBarker:2006}, where combinators apply to combinators. Interesting property of that system: they use Lift to allow them only one Scope combinator (i.e.~the thing on the left can always be the functor). Central question: the proper way to relate the continuations mode slashes with the direct mode slashes. The way I did it in my diss appendix was essentially to have a unimodal grammar, but a more elegant solution would be welcome (and important since this is after all a categorial grammar conference!). %
	
	\item Adding side effects (\citealt{Wadler:1994, Wadler:1995, Shan:2002}): monads. A monad is a triple \ab{\textsf{M},\,\eta,\,\star} of a type constructor \textsf{M}, an injection function $\eta$ of type $a \ra \textsf{M}\,a$ (given any type $a$), and a recipe for sequencing $\star$ of type $\textsf{M}\,a \ra (a \ra \textsf{M}\,b) \ra \textsf{M}\,b$ (given any types $a,b$). %
	
	\item Monad laws / punting
	\begin{defi}
	\end{defi}
	
	\item The key to connecting monads with continuations is realizing that the type of $(\star)$ can be rewritten using the continuized type constructor as $\textsf{M}\,a \ra \textsf{K}\,a\,\textsf{M}\,b$%

	\item Relating monads to continuized grammars: identify \bsf{lift} with $\star$, \bsf{triv} with $\eta$. But \bsf{scope} stays the same.%	
	
	\item Regular lifting is a theorem, though the types are further specified:
	\begin{fact}
		
	\end{fact}
\end{itemize}

\section{Finding the dynamic monad}
\begin{itemize}
	\item The meat of PLA (\citealt{Dekker:1994}), translated into a compositional framework: sentences denote relations on sequences. Non-empty relations correspond to truth. Non-functional pairs in the relation correspond to nondeterminism introduced by indefinites (and perhaps disjunction). Conjunction corresponds to relation composition, which pipes the sequences output by the left conjunct to the right conjunct.%
	\[\begin{array}{r@{}l}
		\sv{\text{a linguist}} &{}= \lambda ki.\displaystyle\bigcup_{\mathclap{x\in\,\textsf{ling}}}k\,x\,(i + x)%
		\\
		\sv{\text{a linguist left}} &{}= \lambda i.\,\{i + x : x \in \textsf{ling} \wedge x \in \textsf{left}\}%
	\end{array}\]%

	\item Two key bits: state modification for introducing drefs, nondeterminism to allow for failure and referring treatment of indefinites. A different perspective on this: treating nondeterminism and state modification as side effects, within a functional programming setting for side effects. %
	
	\item Monad for state (generalization of monad for environment-sensitivity). Assume that $\gamma$ is the type of ``contexts of evaluation''. For our purposes, we might think of $\gamma$ as inhabited by \emph{sequences of discourse referents}.%
	\begin{defi}[The State monad]\label{state}
		\[\begin{array}[t]
			{@{}l@{}c@{}l@{}}
			\textsf{M}\,a &{}\Coloneqq{} &\gamma \ra a \times \gamma	%
			\\
			\eta\,x &{}\ceq{} &\lambda i.\,\ab{x,\,i}
			\\
			m \star k &{}\ceq{} &\lambda i.\,k\,(m\,i)_0\,(m\,i)_1%
		\end{array}\]
	\end{defi}
	
	\item Given our identification of $\gamma$ with the set of sequences of discourse referents, a natural operation to suppose as associated with dref introduction is sequence extension (cf.~\citealt{Groote:2006, Unger:2012, Charlow:diss}). These definitions rely on the notion of extending a sequence (e.g., if $i \ceq abcd$, $i+e = abcde$) and retrieving the last, i.e.~most topical, discourse reference (e.g., if $i \ceq abcde$, $i_\top = e$).\footnote{This is an extremely crude measure of topicality, but it will suffice to illustrate the main points.}%
	\begin{defi}[Dref introduction]
		\[m^\rhd \ceq m \star \lambda xi.\,\ab{x,\,i + x}\]
	\end{defi}
	\begin{defi}[Dref retrieval]
		\[\bsf{he} \ceq \lambda i.\,\ab{i_\top,\,i}\]
	\end{defi}
	
	\item An example, \emph{Al left} (call this \bsf{X}):
	\[(\eta\,\textsf{a})^\rhd\! \star \lambda x.\,\eta\,(\textsf{left}\,x) = \lambda i.\,\ab{\textsf{left}\,\textsf{a},\,i+\textsf{a}}\]%
	
	\item Pronoun sentence \emph{he was tired} (call this \bsf{Y}):
	\[\bsf{he} \star \lambda x.\,\eta\,(\textsf{tired}\,x) = \lambda i.\,\ab{\textsf{tired}\,i_\top,\,i}\]%
	
	\item Sequencing the two. The dref introduced by the proper name in the first sentence is accessed by the pronoun in the second. %
	\[\begin{array}{r@{}l}
		\bsf{X} \star \lambda p.\,\bsf{Y}&{}\star \lambda q.\,\eta\,(p \wedge q) %
		\\
		&{}= \lambda i.\,\ab{\textsf{left}\,\textsf{a} \wedge \textsf{tired}\,\textsf{a},\,i+\textsf{a}}%
	\end{array}\]
	
	\item So we have state modification as a side effect. To say something about indefinites, i.e.~to allow them to refer and introduce drefs nondeterministically, we need to enrich the state monad with nondeterministic side effects. The monad for nondeterminism is the Set monad, given in Definition \ref{set}:%
	\begin{defi}[The Set monad]\label{set}
		\[\begin{array}[t]
			{@{}l@{}c@{}l@{}}
			\textsf{M}\,a &{}\Coloneqq{} &a \ra t%
			\\
			\eta\,x &{}\ceq{} &\{x\}
			\\
			m \star k &{}\ceq{} &\displaystyle\bigcup_{\mathclap{x\in \,m}}k\,x%
		\end{array}\]
	\end{defi}

	\item Use StateT to stitch the two together. Given any monad ${\cal M}= \ab{\textsf{L},\,\eta_\textsf{L},\,\star_\textsf{L}}$, StateT is a recipe for building a new monad with which adds State-type functionality to ${\cal M}$:\footnote{Fn. about SetT}%
	\begin{defi}[The StateT monad transformer]\label{statet}
		\[\begin{array}[t]
			{@{}l@{}c@{}l@{}}
			\textsf{M}\,a &{}\Coloneqq{} &\gamma \ra \textsf{L}\,(a \times \gamma)%
			\\
			\eta\,x &{}\ceq{} &\lambda i .\,\eta_\textsf{L}\,\ab{x,\,i}
			\\
			m \star k &{}\ceq{} &\lambda i.\, m\,i\star_\textsf{L} \lambda \pi.\,k\,\pi_0\,\pi_1%
		\end{array}\]
	\end{defi}
	\begin{defi}[The State\_Set monad]\label{stateset}
		\[\begin{array}[t]
			{@{}l@{}c@{}l@{}}
			\textsf{M}\,a &{}\Coloneqq{} &\gamma \ra (a \times \gamma) \ra t%
			\\
			\eta\,x &{}\ceq{} &\lambda i.\left\{\ab{x,\,i}\right\}
			\\
			m \star k &{}\ceq{} &\lambda i.\displaystyle\bigcup_{\mathclap{\pi \in mi}}k\,\pi_0\,\pi_1%
		\end{array}\]
	\end{defi}

	\item Static lexicon, dynamic lexicon
	
	\item Modular treatment of binding.%
	\[\begin{array}{ll}
		\text{Previous}:& \bsf{bind}\,m \ceq \lambda k.\,m\,(\lambda x.\,k\,x\,x)%
		\\
		\text{Proposal}:& \bsf{bind}\,m \ceq \lambda k.\,m\,(\lambda xi.\,k\,x\,(i + x))%
	\end{array}\]
	
	\item Summing up: three combinators for ``order-insensitive'' (i.e.~continuized combination). \bsf{unit}, \bsf{run}, \bsf{bind}. Compare Figures \ref{fig1} and \ref{fig2}.%
\end{itemize}

\section{Examples}
\begin{itemize}
	\item Some upshots: no dynamic conjunction, completely standard model theory (cf.~\citealt{Groote:2006}). ``Contexts of evaluation'' are constructed on the fly. %
	
	\item Cross-sentential anaphora. Let us assume that \emph{scope islands}, e.g., tensed clauses, need to be evaluated---i.e., lowered (cf.~\citealt{Barker:2002, BarkerShan:2008}). In practice, this means a tensed clause must pass through a stage where it denotes something of type $\textsf{M}\,t$. There are a variety of options for enforcing this syntactically, but here we concentrate on the semantic upshots of forced evaluation.\footnote{In terms of LF, forcing evaluation of a scope island corresponds to disallowing QR out of the scope island.} the indefinite's side effects influence the evaluation of the second clause, even as the indefinite scopes within its clause. %
	\[\begin{array}{r}
		\bsf{a.man.left} \star \lambda p.\,\bsf{he.tired} \star \lambda q.\,\eta\,(p \wedge q)%
		\\
		= \bsf{a.man} \star \lambda x.\,\eta\,(\textsf{left}\,x \wedge \textsf{tired}\,x)%
	\end{array}\]
	\begin{figure*}
		%\begin{saveboxes}
		\newsavebox{\partbox}\setbox\partbox=\hbox{\scriptsize\pruf{%
				\AXC{$\bsf{a.man} : \textsf{M}\,e$}
				\lab{$\star$}
				\UIC{$\lambda k.\,\bsf{a.man} \star k : \textsf{K}\,e\,\textsf{M}\,t$}%
				\lab{$\rhd$}
				\UIC{$\lambda k.\,\bsf{a.man}^\rhd\! \star k : \textsf{K}\,e\,\textsf{M}\,t$}%
				\AXC{$\textsf{left} : e \backslash t$}
				\lab{$\uparrow$}
				\UIC{$\lambda k.\,k\,\textsf{left} : \textsf{K}\,(e \backslash t)\,\textsf{M}\,t$}%
				\lab{$\bbslash$}
				\BIC{$\lambda k.\,\bsf{a.man}^\rhd\! \star \lambda x.\,k\,(\textsf{left}\,x) : \textsf{K}\,t\,\textsf{M}\,t$}%
				\lab{$\downarrow$}
				\UIC{$\bsf{a.man}^\rhd\! \star \lambda x.\,\eta\,(\textsf{left}\,x) : \textsf{M}\,t$}%
				}}%
		\newsavebox{\partboxx}\setbox\partboxx=\hbox{\scriptsize\pruf{%
				\AXC{$\bsf{he} : \textsf{M}\,e$}
				\lab{$\star$}
				\UIC{$\lambda k.\,\bsf{he} \star k: \textsf{K}\,e\,\textsf{M}\,t$}%
				\AXC{$\textsf{tired} : e \backslash t$}
				\lab{$\uparrow$}
				\UIC{$\lambda k.\,k\,\textsf{tired} : \textsf{K}\,(e \backslash t)\,\textsf{M}\,t$}%
				\lab{$\bbslash$}
				\BIC{$\lambda k.\,\bsf{he} \star \lambda y.\,k\,(\textsf{tired}\,y) : \textsf{K}\,t\,\textsf{M}\,t$}%
				\lab{$\downarrow$}
				\UIC{$\bsf{he} \star \lambda y.\,\eta\,(\textsf{tired}\,y) : \textsf{M}\,t$}}}%
		%\end{saveboxes}
		{\small{\scriptsize\[\begin{array}{c}
			\pruf{%
			\AXC{$\boxed{\usebox\partbox}$}
			\lab{$\star$}
			\UIC{$\lambda k.\,\bsf{a.man}^\rhd\! \star \lambda x.\,k\,(\textsf{left}\,x) : \textsf{K}\,t\,\textsf{M}\,t$}%
			\AXC{$\textsf{and} : (t \backslash t)/t$}
			\lab{$\uparrow$}
			\UIC{$\lambda k.\,k\,\textsf{and} : \textsf{K}\,((t \backslash t)/t)\,\textsf{M}\,t$}%
			\AXC{$\boxed{\usebox\partboxx}$}
			\lab{$\star$}
			\UIC{$\lambda k.\,\bsf{he} \star \lambda y.\,k\,(\textsf{tired}\,y) : \textsf{K}\,t\,\textsf{M}\,t$}%
			\lab{$\sslash$}
			\BIC{$\lambda k.\,\bsf{he} \star \lambda y.\,k\,(\lambda p.\,p \wedge \textsf{tired}\,y) : \textsf{K}\,(t \backslash t)\,\textsf{M}\,t$}%
			\lab{$\bbslash$}
			\BIC{$\lambda k.\,\bsf{a.man}^\rhd\! \star \lambda x.\,\bsf{he} \star \lambda y.\,k\,(\textsf{left}\,x \wedge \textsf{tired}\,y) : \textsf{K}\,t\,\textsf{M}\,t$}%
			\lab{$\downarrow$}
			\UIC{$\bsf{a.man}^\rhd\! \star \lambda x.\,\bsf{he} \star \lambda y.\,\eta\,(\textsf{left}\,x \wedge \textsf{tired}\,y) : \textsf{M}\,t$}%
			\lab{equiv}
			\UIC{$\bsf{a.man}^\rhd\! \star \lambda x.\,\eta\,(\textsf{left}\,x \wedge \textsf{tired}\,x) : \textsf{M}\,t$}%
			}%
			\\[-1em]
		\end{array}\]}
		\caption{Cross-sentential anaphora.}
		\label{fig:derivation}}
	\end{figure*}
	
	\item Compare universals. After ending the derivation at the clause boundary, we're left with a pure computation. The universal's side effects have died on evaluation.%
	\[\eta\,(\forall x.\,\textsf{ling}\,x \Rightarrow \textsf{left}\,x)\]
	
	\item Donkey anaphora works similarly. Take the following. The restrictor $c$ here acquires a kind of monadic scope, via $\star$, over the nuclear scope $k$. This means any side effects inside $c$ influence the context of evaluation for $k$. However, once $k$ is grabbed, the wide-scoping negation discharges side effects (as is standard in dynamic systems). %
	\[\sv{\text{every}} \ceq \lambda ck.\,\bsf{not}\,(\bsf{a}\,c \star \lambda x.\,\bsf{not}\,(k\,x))\]%
	
	\item Islands: a clause must denote a $\textsf{M}\,t$
\end{itemize}

\section{Discussion}
\begin{itemize}
	\item 
	
	\item Compare PLA, where only sentences are imbued with context change potential. %
	
	\item Variable-free, directly compositional (\citealt{Jacobson:1999}).
	
	\item Effects recognized in the types. 
	
	\item Theory extends to scope islands, wide range of exceptional binding configurations \citealt{Charlow:diss}. %
	
	\item Extends to pair-list phenomena, functional quantification: \citealt{Bumford:inc}%
\end{itemize}

{\small\bibliography{bqhatevwr}}
\end{document}